<template>
    <template if:false={isLoading}>
        <template if:false={recordId}>
            <header class="slds-modal__header" id="modal-heading-01">
                <h2 class="slds-text-heading_medium slds-hyphenate">Nuevo registro: {objectApiName}</h2>
            </header>  
            <template if:true={cargado}>
                <template if:true={isList}>
                    <lightning-combobox
                        name="progre"
                        label="Record Type"
                        value={recordTypeId}
                        placeholder="Select Record Type"
                        options={option}
                        onchange={handleChangeRt} >
                    </lightning-combobox>
                </template>
        
            </template>
        </template>
        <template if:true={rules}>
            <lightning-card >
                <div class="slds-p-around_xxx-small">
        
                        <template if:true={infoSectionsLayout}>
                            
                            <lightning-accordion allow-multiple-sections-open>
                                <template for:each={infoSectionsLayout} for:item="sectionsLayout">
                                    <lightning-accordion-section name={sectionsLayout.id} label={sectionsLayout.heading} key={sectionsLayout.id}>
                                        
                                        <lightning-record-edit-form record-id={recordId} object-api-name={objectApiName} style="width: 100%;" >
                                            <div class="slds-grid">
                                                <div class="slds-col slds-size_1-of-2">
                                                    <template for:each={sectionsLayout.lstFields} for:item="field" for:index="index">                            
                                                                <template if:true={field.boleanoColumnas}>
                                                                    <template if:true={field.metadata.isReference}>
                                                                        <div class="lgc-bg" key={field.key}>
                                                                            <c-jcv-lookup
                                                                                data-fieldapiname={field.apiName}
                                                                                api-name={field.apiName}
                                                                                value={field.fieldValue}
                                                                                disabled={field.isReadOnly} 
                                                                                time={field.ts}
                                                                                required={field.isRequired}
                                                                                record-id={recordId}
                                                                                record-parent={field.fieldValue}
                                                                                object-api-name={objectApiName}
                                                                                onchange={handleChange}
                                                                                onloaddata={loadParent}>
                                                                            </c-jcv-lookup>
                                                                        </div>
                                                                    </template>
                                                                    <template if:false={field.metadata.isReference}>
                                                                    
                                                                        
                                                                        <lightning-input-field 
                                                                            key={field.key}
                                                                            data-fieldapiname={field.apiName}
                                                                            variant= "label-inline"
                                                                            required={field.metadata.computedIsRequired}
                                                                            disabled={field.metadata.computedIsReadOnly}
                                                                            field-name={field.apiName}
                                                                            value={field.fieldValue}
                                                                            onchange={handleField}>
                                                                        </lightning-input-field>
                                                                    </template>
                                                                </template>
                                                    </template>
                                                </div>
                                                <div class="slds-col slds-size_1-of-2">
                                                    <template for:each={sectionsLayout.lstFields} for:item="field" for:index="index">                            
                                                                <template if:false={field.boleanoColumnas}>
        
                                                                    <template if:true={field.metadata.isReference}>
                                                                        <div class="lgc-bg" key={field.key}>
                                                                            <c-jcv-lookup
                                                                                data-fieldapiname={field.apiName}
                                                                                api-name={field.apiName}
                                                                                value={field.fieldValue}
                                                                                disabled={field.isReadOnly} 
                                                                                time={field.ts}
                                                                                required={field.isRequired}
                                                                                record-id={recordId}
                                                                                record-parent={field.fieldValue}
                                                                                object-api-name={objectApiName}
                                                                                onchange={handleChange}
                                                                                onloaddata={loadParent}>
                                                                            </c-jcv-lookup>
                                                                    
                                                                        </div>
                                                                    </template>
                                                                    <template if:false={field.metadata.isReference}>
                                                                        <lightning-input-field 
                                                                            key={field.key}
                                                                            data-fieldapiname={field.apiName}
                                                                            variant= "label-inline"
                                                                            required={field.metadata.computedIsRequired}
                                                                            disabled={field.metadata.computedIsReadOnly}
                                                                            field-name={field.apiName}
                                                                            value={field.fieldValue}
                                                                            onchange={handleField}>
                                                                        </lightning-input-field>
                                                                    
                                                                    
                                                                    </template>
                                                                                                                
                                                                </template>
                                                    </template>
                                                </div>
                                            </div>
                                            </lightning-record-edit-form>
                
                
                
                                    
                                    </lightning-accordion-section>
                                </template>
                            </lightning-accordion>
                
                        </template>   
                
                </div>


                <template if:true={recordId}>
                    <div class="slds-p-around_medium">
                        <lightning-button
                            variant="brand"
                            type="submit"
                            name="save"
                            label="Save"
                            onclick={handleClick}>
                        </lightning-button>
                    </div>
                </template>
                <template if:false={recordId}>
                    <footer class="slds-modal__footer">
                        <center>
                            <lightning-button tabindex="-1" label="Cancelar" variant="neutral" onclick={cancelNew}></lightning-button>&nbsp;&nbsp;&nbsp;&nbsp; 
                            <lightning-button tabindex="-1" label="Aceptar" variant="brand" onclick={handleClickNew} data-accion="Aceptar"></lightning-button>
                        </center>
                    </footer>   
                </template>
            </lightning-card>
        </template>
    </template>
    <template if:true={isLoading}>
        <div class="exampleHolder">
            <lightning-spinner alternative-text="Loading" size="large"></lightning-spinner>
        </div>
    </template>










</template>